{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kaka/Desktop/my-expenses/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport { AUTH_USER, AUTH_ERROR } from \"./types\";\nimport { userStorageKey } from \"../../constants/storage\";\nexport var authenticateAsync = function authenticateAsync(serverCall, doneCallback) {\n  var errorCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (error) {};\n  return function _callee(dispatch) {\n    var response, error, user, _error;\n\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(serverCall());\n\n          case 3:\n            response = _context.sent;\n\n            if (response.data.succeed) {\n              _context.next = 9;\n              break;\n            }\n\n            error = response.data.message;\n            dispatch({\n              type: AUTH_ERROR,\n              payload: error\n            });\n            errorCallback(error);\n            return _context.abrupt(\"return\");\n\n          case 9:\n            user = response.data.content;\n            sessionStorage.setItem(userStorageKey.token, user.token);\n            sessionStorage.setItem(userStorageKey.firstName, user.firstName);\n            sessionStorage.setItem(userStorageKey.lastName, user.lastName);\n            _context.next = 15;\n            return _regeneratorRuntime.awrap(dispatch({\n              type: AUTH_USER,\n              payload: {\n                authenticated: user.token,\n                firstName: user.firstName,\n                lastName: user.lastName\n              }\n            }));\n\n          case 15:\n            doneCallback();\n            _context.next = 23;\n            break;\n\n          case 18:\n            _context.prev = 18;\n            _context.t0 = _context[\"catch\"](0);\n            _error = \"Something went wrong. Please try again later.\";\n            dispatch({\n              type: AUTH_ERROR,\n              payload: _error\n            });\n            errorCallback(_error);\n\n          case 23:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 18]]);\n  };\n};\nexport var logOut = function logOut() {\n  sessionStorage.removeItem(userStorageKey.token);\n  sessionStorage.removeItem(userStorageKey.firstName);\n  sessionStorage.removeItem(userStorageKey.lastName);\n  return {\n    type: AUTH_USER,\n    payload: {\n      authenticated: \"\",\n      firstName: \"\",\n      lastName: \"\"\n    }\n  };\n};\nexport var forgotPasswordAsync = function forgotPasswordAsync(serverCall, doneCallback) {\n  var errorCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (error) {};\n  return function _callee2(dispatch) {\n    var error;\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(serverCall());\n\n          case 3:\n            doneCallback();\n            _context2.next = 10;\n            break;\n\n          case 6:\n            _context2.prev = 6;\n            _context2.t0 = _context2[\"catch\"](0);\n            error = \"We cannot process your request.\";\n            errorCallback(error);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 6]]);\n  };\n};\nexport var resetPasswordAsync = function resetPasswordAsync(serverCall, doneCallback) {\n  var errorCallback = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : function (error) {};\n  return function _callee3(dispatch) {\n    var error;\n    return _regeneratorRuntime.async(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(serverCall());\n\n          case 3:\n            doneCallback();\n            _context3.next = 10;\n            break;\n\n          case 6:\n            _context3.prev = 6;\n            _context3.t0 = _context3[\"catch\"](0);\n            error = \"We cannot reset your password.\";\n            errorCallback(error);\n\n          case 10:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[0, 6]]);\n  };\n};","map":{"version":3,"sources":["/Users/kaka/Desktop/my-expenses/web/src/redux/auth/actions.js"],"names":["AUTH_USER","AUTH_ERROR","userStorageKey","authenticateAsync","serverCall","doneCallback","errorCallback","error","dispatch","response","data","succeed","message","type","payload","user","content","sessionStorage","setItem","token","firstName","lastName","authenticated","logOut","removeItem","forgotPasswordAsync","resetPasswordAsync"],"mappings":"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","sourcesContent":["import { AUTH_USER, AUTH_ERROR } from \"./types\";\r\nimport { userStorageKey } from \"../../constants/storage\";\r\n\r\nexport const authenticateAsync = (\r\n  serverCall,\r\n  doneCallback,\r\n  errorCallback = error => {}\r\n) => async dispatch => {\r\n  try {\r\n    const response = await serverCall();\r\n    if (!response.data.succeed) {\r\n      const error = response.data.message;\r\n      dispatch({ type: AUTH_ERROR, payload: error });\r\n      errorCallback(error);\r\n      return;\r\n    }\r\n\r\n    const user = response.data.content;\r\n\r\n    sessionStorage.setItem(userStorageKey.token, user.token);\r\n    sessionStorage.setItem(userStorageKey.firstName, user.firstName);\r\n    sessionStorage.setItem(userStorageKey.lastName, user.lastName);\r\n\r\n    await dispatch({\r\n      type: AUTH_USER,\r\n      payload: {\r\n        authenticated: user.token,\r\n        firstName: user.firstName,\r\n        lastName: user.lastName\r\n      }\r\n    });\r\n\r\n    doneCallback();\r\n  } catch (err) {\r\n    const error = \"Something went wrong. Please try again later.\";\r\n    dispatch({ type: AUTH_ERROR, payload: error });\r\n    errorCallback(error);\r\n  }\r\n};\r\n\r\nexport const logOut = () => {\r\n  sessionStorage.removeItem(userStorageKey.token);\r\n  sessionStorage.removeItem(userStorageKey.firstName);\r\n  sessionStorage.removeItem(userStorageKey.lastName);\r\n\r\n  return {\r\n    type: AUTH_USER,\r\n    payload: { authenticated: \"\", firstName: \"\", lastName: \"\" }\r\n  };\r\n};\r\n\r\nexport const forgotPasswordAsync = (\r\n  serverCall,\r\n  doneCallback,\r\n  errorCallback = error => {}\r\n) => async dispatch => {\r\n  try {\r\n    await serverCall();\r\n    doneCallback();\r\n  } catch (err) {\r\n    const error = \"We cannot process your request.\";\r\n    errorCallback(error);\r\n  }\r\n};\r\n\r\nexport const resetPasswordAsync = (\r\n  serverCall,\r\n  doneCallback,\r\n  errorCallback = error => {}\r\n) => async dispatch => {\r\n  try {\r\n    await serverCall();\r\n\r\n    doneCallback();\r\n  } catch (err) {\r\n    const error = \"We cannot reset your password.\";\r\n    errorCallback(error);\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}